FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .

ARG NEXT_PUBLIC_FETCH_TIMEOUT
ENV NEXT_PUBLIC_FETCH_TIMEOUT=${NEXT_PUBLIC_FETCH_TIMEOUT:-8000}

RUN npm run build

ENV NODE_ENV production
ENV HOSTNAME=0.0.0.0
ENV PORT=3003

EXPOSE 3003

CMD ["npm", "start"]